<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MovieTogether</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link href="/css/style.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"
            integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>

    <script>
        $(document).ready(function (){
            let moviename = localStorage.getItem("moviename");
            if(moviename == "범죄도시3"){
                moviename = "범죄도시 3"
            }
            $.ajax({
                url:"https://api.themoviedb.org/3/search/movie?api_key=ad2f7390e457d7dc76e7fda8dcae77b2&language=ko-KR&page=1&query="+moviename,
                type:"GET",
                data:{},
                success: function (data){
                    const MovieDetailList = data.results;
                    const imageBaseUrl = "https://image.tmdb.org/t/p/w500"
                    if(MovieDetailList.length >0) {
                        for (let i = 0; i < MovieDetailList.length; i++) {

                            let tag = "<div class=\"card\" style=\"max-height: max-content;\"><a class='text-decoration-none text-black' href='/detail/data/" + MovieDetailList[i].title + "'>" // 디테일 페이지로 이동하기위한 링크 추가
                            tag += "<div class=\"row g-0\">"
                            tag += "<div class=\"col-md-5\">"
                            tag += "<img src=\"" + imageBaseUrl + MovieDetailList[i].poster_path + "\" alt=\"그림 들어갈 부분\" class=\"img-fluid rounded-start\">"
                            tag += "</div>"
                            tag += "<div class=\"col-7 \">"
                            tag += "<div class=\"card-body\">"
                            tag += "<h5 class=\"card-title\">" + MovieDetailList[i].title + "</h5>"
                            tag += "<p class=\"card-text\">" + MovieDetailList[i].overview + "</p>"
                            tag += "<p class=\"card-text\">" + MovieDetailList[i].vote_average + "</p>"
                            tag += "</div>"
                            tag += "</div>"
                            tag += "</div>"
                            tag += "</a></div>"
                            $("main").append(tag);
                        }
                    }else{
                        alert("검색 결과가 없습니다!")
                        history.back();
                    }
                }
            })
        })


    </script>
    <style>

    </style>
</head>
<body>
<header th:replace="~{layout/header :: header-basic}"></header>
<main class="container-md my-4">
</main>
<footer th:replace="~{layout/footer :: footer-basic}"></footer>
</body>
</html>