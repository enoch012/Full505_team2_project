<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link href="/css/style.css" rel="stylesheet">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"
            integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
    <style>

    </style>
</head>
<body>
<header th:replace="~{layout/header :: header-basic}"></header>
<main class="container-md my-4">
<ul class="pagination justify-content-center">
    <li class="page-item disabled">
        <a href="" tabindex="-1" aria-disabled="true">Previous</a>
    </li>
    <li class="page-item"><a class="page-link" href="#" id="pageNo">1</a></li>
    <li class="page-item"><a class="page-link" href="#">2</a></li>
    <li class="page-item"><a class="page-link" href="#">3</a></li>
    <li class="page-item"><a class="page-link" href="#">4</a></li>
    <li class="page-item"><a class="page-link" href="#">5</a></li>
    <li class="page-item"><a class="page-link" href="#">6</a></li>
    <li class="page-item"><a class="page-link" href="#">7</a></li>
    <li class="page-item"><a class="page-link" href="#">8</a></li>
    <li class="page-item"><a class="page-link" href="#">9</a></li>
    <li class="page-item"><a class="page-link" href="#">10</a></li>
    <li class="page-item">
        <a class="page-link" href="">Next</a>
    </li>
</ul>
    <script>
        $(Document).ready(function () {
            let PageNo = 1;
            $("a.page-link").click(function (event){
                event.preventDefault();// 링크 클릭 시 페이지 이동을 방지.
                PageNo = parseInt($(this).text());
            })
            $.ajax({
                url: "https://api.themoviedb.org/3/movie/now_playing?language=ko&page="+PageNo,
                headers: {
                    Authorization: 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiJhZDJmNzM5MGU0NTdkN2RjNzZlN2ZkYThkY2FlNzdiMiIsInN1YiI6IjY0YTIyNDc0YzM5MGM1MDEyZDE3MjI0OCIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.AKhLoI3OcnRdvK3KNLBKIFzTJccVZv_WN40cgsMPjTY'
                },
                type: "GET",
                data: {},
                success: function (data) {
                    const MovieList = data.results;
                    const imageBaseUrl = "https://image.tmdb.org/t/p/w500"
                    if (MovieList.length > 0) {
                        for (let i = 0; i < MovieList.length; i++) {
                            let tag = "<div class=\"card\" style=\"height:750px;\"><a class='text-decoration-none text-black' href='/detail/data/" + MovieList[i].title + "'>" // 디테일 페이지로 이동하기위한 링크 추가
                            tag += "<div class=\"row g-0\">"
                            tag += "<div class=\"col-md-5\">"
                            tag += "<img src=\"" + imageBaseUrl + MovieList[i].poster_path + "\" alt=\"그림 들어갈 부분\" class=\"img-fluid rounded-start\">"
                            tag += "</div>"
                            tag += "<div class=\"col-7 \">"
                            tag += "<div class=\"card-body\">"
                            tag += "<h5 class=\"card-title\">" + MovieList[i].title + "</h5>"
                            tag += "<p class=\"card-text\">" + MovieList[i].overview + "</p>"
                            tag += "<p class=\"card-text\">" +"평점"+ MovieList[i].vote_average + "</p>"
                            tag += "</div>"
                            tag += "</div>"
                            tag += "</div>"
                            tag += "</a></div>"
                            $("main").append(tag);
                        }
                    } else {
                        alert("영화정보를 불러오는중 오류가 발생했습니다.")
                        history.back();
                    }
                }
            })
        })

    </script>
</main>
<footer th:replace="~{layout/footer :: footer-basic}"></footer>
</body>
</html>