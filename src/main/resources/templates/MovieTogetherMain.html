<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MovieTogether</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link href="/css/style.css" rel="stylesheet">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
            crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"
            integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>

    <script>
        $(document).ready(function (){
            let today = new Date();
            let year = today.getFullYear();
            let month = today.getMonth()+1;
            let day = today.getDate()-1;
            let targetDate = year.toString().padStart(4,'0')+month.toString().padStart(2,'0')+day.toString().padStart(2,'0');
            $.ajax({
                url:"http://kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json?key=0cef8373c2ef480da57a59e3967ca38f&targetDt="+targetDate,
                type:"GET",
                data:{},
                success: function (data){
                    const boxOfficeResult = data.boxOfficeResult;
                    const dailyBoxOfficeList = boxOfficeResult.dailyBoxOfficeList;
                    const card = $("div.row");
                    for(let i = 0; i<dailyBoxOfficeList.length; i++){
                        let tag = "<div class=\"col-sm-3\">"
                        tag +="<div class=\"card\" style=\"width: 18rem;\">"
                        tag +="<img src=\"\" alt=\"아직은 빈 공간\" class=\"card-img-top\">"
                        tag +="<div class=\"card-img-overlay\">"
                        tag +="<p>"+dailyBoxOfficeList[i].rank+"</p>"
                        tag +="</div>"
                        tag +="<div class=\"card-body\">"
                        tag +="<h4 class=\"card-title\">"+dailyBoxOfficeList[i].movieNm +"</h4>"
                        tag +="<p class=\"card-text\">"+"평점?"+"총 관람객:"+dailyBoxOfficeList[i].audiAcc+"<br>"+"상영시작날짜"+dailyBoxOfficeList[i].openDt+"</p>"
                        tag +="</div>"
                        tag +="</div>"
                        tag +="</div>"
                        card.append(tag);
                    }
                },
                error: function (){
                    alert("서버 통신 중 오류 발생")

                }
            })
        });
    </script>
    <style>

    </style>
</head>
<body>
<header th:replace="~{layout/header :: header-basic}"></header>
<main class="container-md my-4">
    <h1>테스트 페이지입니다.</h1>
        <div class="row">
        </div>
</main>
<footer th:replace="~{layout/footer :: footer-basic}"></footer>
</body>
</html>